<launch>
  <!-- p2os -->
  <node name="rostopic" pkg="rostopic" type="rostopic" args="pub -1 /cmd_motor_state p2os_msgs/MotorState 1"/>
  <node pkg="p2os_driver" name="p2os_driver" type="p2os_driver"/>

  <include file="$(find p2os_launch)/launch/teleop_joy.launch"/>
  <include file="$(find p2os_launch)/launch/teleop_keyboard.launch"/>

  <!-- urdf -->
  <param name="robot_description" command="$(find xacro)/xacro $(find pioneer3dx_cartographer)/defs/pioneer3dx.xacro"/>

  <node pkg="robot_state_publisher" type="state_publisher" name="robot_state_publisher">
    <param name="publish_frequency" type="double" value="30.0"/>
    <param name="tf_prefix" type="string" value=""/>
  </node>

  <node pkg="p2os_urdf" type="p2os_publisher_3dx" name="publisher"/>

  <!-- tf -->
  <include file="$(find p2os_launch)/launch/tf_base_link_to_laser.launch"/>
  <!--node pkg="tf" type="static_transform_publisher" name="imu_link" args="0 0 0 0 0 0 base_link imu 100" /-->

  <!-- Laser scanner -->
  <include file="$(find p2os_launch)/launch/sicklms.launch"/>

  <!-- imu -->
  <!--node name="imu_demo" pkg="pioneer3dx_cartographer" type="imu_demo" /-->

  <!-- cartographer -->
  <node name="cartographer_node" pkg="cartographer_ros" type="cartographer_node" args="-configuration_directory $(find pioneer3dx_cartographer)/configuration_files -configuration_basename pioneer.lua" output="screen"></node>

  <node name="cartographer_occupancy_grid_node" pkg="cartographer_ros" type="cartographer_occupancy_grid_node" args="-resolution 0.05"/>

  <!-- rviz -->
  <node name="rviz" pkg="rviz" type="rviz" required="true" args="-d $(find pioneer3dx_cartographer)/configuration_files/pioneer.rviz"/>
</launch>